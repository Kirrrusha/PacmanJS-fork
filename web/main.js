(()=>{"use strict";var t,e,i={6594:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(1761),s=i(2842),n=i(9336),r=i(7927),a=i(5498),h=i(5882),u=i(8065),c=function(){function t(t,e,i){void 0===t&&(t=1),this.scale=t||1,this.loadingAssetData={},this.responses={},this.callback=null,this.audio=e,this.assetRoot=i}return t.prototype.addJson=function(t,e){var i=this;if(void 0===e&&(e=t),this.assetRoot&&(e=this.assetRoot+e),!this._isAlreadyTracked(t)){this.loadingAssetData[t]={type:s.AssetType.JSON},console.log("Adding: "+t+" => "+e+", remaining == "+n.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback));var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE){var e=o.responseText;i._completed(t,e)}},o.open("GET",e,!0),o.send(null)}},t.prototype.addCanvas=function(t,e){var i=this;this.assetRoot&&(e=this.assetRoot+e);var o=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+n.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),o.addEventListener("load",(function(){var e=r.default.resize(o,i.scale);i._completed(t,e)})),o.src=e)},t.prototype.addImage=function(t,e,i){var o=this;void 0===i&&(i=!1),this.assetRoot&&(e=this.assetRoot+e);var h=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+n.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),h.addEventListener("load",(function(){var e=r.default.resize(h,o.scale),s=new a.default(e);i&&s.makeColorTranslucent(0,0),o._completed(t,s)})),h.src=e)},t.prototype.addImageAtlasContents=function(t,e,i){var o=this;this.assetRoot&&(e=this.assetRoot+e);var a=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+n.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),a.addEventListener("load",(function(){var e=r.default.resize(a,o.scale),s=new u.default(e,i),n="string"==typeof i.prefix?i.prefix:i.prefix?t+".":"",h=s.parse();for(var c in h)h.hasOwnProperty(c)&&(o.responses[n+c]=h[c]);o._completed(t,s)})),a.src=e)},t.prototype.addSound=function(t,e,i,o){var n=this;if(void 0===i&&(i=0),void 0===o&&(o=!0),this.audio.isInitialized()){if(this._isAlreadyTracked(t))return;this.loadingAssetData[t]={type:s.AssetType.AUDIO},this.assetRoot&&(e=this.assetRoot+e);var r=new XMLHttpRequest;r.onload=function(){n.audio.context.decodeAudioData(r.response,(function(e){var s=new h.default(t,e,i||0);s.setLoopsByDefaultIfMusic(o),n.audio.addSound(s),n._completed(t,e)}))},r.open("GET",e,!0),r.responseType="arraybuffer",r.send(null)}},t.prototype.addSpriteSheet=function(t,e,i,h,u,c,l){var d=this;void 0===u&&(u=0),void 0===c&&(c=0),void 0===l&&(l=!1),u=u||0,c=c||0,i*=this.scale,h*=this.scale,u*=this.scale,c*=this.scale,this.assetRoot&&(e=this.assetRoot+e);var p=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+n.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),p.addEventListener("load",(function(){var e=r.default.resize(p,d.scale),s=new a.default(e);l&&s.makeColorTranslucent(0,0);var n=new o.default(s,i,h,u,c);d._completed(t,n)})),p.src=e)},t.prototype.addTmxMap=function(t){if(t.tilesets&&t.tilesets.length)for(var e=0;e<t.tilesets.length;e++){var i=t.tilesets[e],o="_tilesetImage_"+i.name;this.addImage(o,i.image)}},t.prototype.getTmxTilesetImage=function(t){return this.responses["_tilesetImage_"+t.name]},t.prototype.get=function(t){return this.responses[t]},t.prototype._isAlreadyTracked=function(t){return this.loadingAssetData[t]?(console.log("A resource with id "+t+" is already loading.  Assuming they are the same"),!0):!!this.responses[t]&&(console.log("A resource with id "+t+" has already been loaded."),!0)},t.prototype.set=function(t,e){this.responses[t]=e},t.prototype._completed=function(t,e){this.loadingAssetData[t]?(this.loadingAssetData[t].type===s.AssetType.JSON&&(e=JSON.parse(e)),this.responses[t]=e,delete this.loadingAssetData[t],console.log("Completed: "+t+", remaining == "+n.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),this.isDoneLoading()&&this.callback?(this.callback.call(this),delete this.callback,console.log("... Callback called and deleted (callback == "+(null!==this.callback)+")"),this.nextCallback&&(this.callback=this.nextCallback,delete this.nextCallback)):console.log("... Not running callback - "+this.isDoneLoading()+", "+(null!==this.callback))):console.error("Resource not found! - "+t)},t.prototype.isDoneLoading=function(){return 0===n.default.getObjectSize(this.loadingAssetData)},t.prototype.onLoad=function(t){this.isDoneLoading()?t():this.callback?this.nextCallback=t:this.callback=t},t}();e.default=c},2842:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.AssetType||(e.AssetType={}))[i.UNKNOWN=0]="UNKNOWN",i[i.IMAGE=1]="IMAGE",i[i.AUDIO=2]="AUDIO",i[i.JSON=3]="JSON"},9107:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.config=t,this.id=-1,this.soundId=void 0,this.source=void 0,this.paused=!1,this.startOffset=-1,this.startTime=-1,this.playedTime=0}return t.prototype.initFromConfig=function(){var t=this;this.id=this.config.id,this.soundId=this.config.soundId,this.source=this.config.audioSystem.context.createBufferSource(),this.source.loop=this.config.loop,this.source.buffer=this.config.buffer,this.config.connectTo instanceof AudioNode?this.source.connect(this.config.connectTo):this.config.connectTo.forEach((function(e){t.source.connect(e)})),this.startOffset=this.config.startOffset||0,this.config.loop||(this.source.onended=this.config.onendedGenerator(this.id))},t.prototype.isPaused=function(){return this.paused},t.prototype.pause=function(){this.paused||(this.source.stop(),this.playedTime+=this.source.context.currentTime-this.startTime,this.paused=!0,this.startTime=0)},t.prototype.resume=function(){if(this.paused){this.paused=!1;var t=this.startOffset;this.initFromConfig(),this.startOffset=t+this.playedTime,this.startOffset=this.startOffset%this.source.buffer.duration;var e=this.source.context.currentTime;this.source.start(e,this.startOffset),this.startTime=e,this.playedTime=0}},t.prototype.start=function(){this.paused=!1,this.initFromConfig();var t=this.source.context.currentTime;this.source.start(t,this.startOffset),this.startTime=t,this.playedTime=0},t}(),o=function(){function t(){this.currentMusic=null,this.sounds={},this.musicFade=.3,this.doFadeMusic=!0,this.muted=!1,this.initialized=!1,this.playingSounds=[],this.soundEffectIdGenerator=0}return t.prototype.createPlayingSound=function(t,e,o,s){var n=this;void 0===e&&(e=!1),void 0===o&&(o=0);var r=this.createSoundEffectId();return new i({audioSystem:this,buffer:this.sounds[t].getBuffer(),connectTo:this.volumeFaderGain,id:r,loop:e,onendedGenerator:function(e){return function(){n.removePlayingSound(e),s&&s(r,t)}},soundId:t,startOffset:o})},t.prototype.createSoundEffectId=function(){return this.soundEffectIdGenerator++},t.prototype.init=function(){var t=window;try{t.AudioContext=t.AudioContext||t.webkitAudioContext,t.AudioContext?(this.context=new t.AudioContext,this.volumeFaderGain=this.context.createGain(),this.volumeFaderGain.gain.setValueAtTime(1,this.context.currentTime),this.volumeFaderGain.gain.value=1,this.volumeFaderGain.connect(this.context.destination),this.initialized=!0):console.log("The Web Audio API is not supported in this browser.")}catch(t){console.error("The Web Audio API is not supported in this browser.")}},t.prototype.addSound=function(t){this.context&&(this.sounds[t.getId()]=t)},t.prototype.fadeOutMusic=function(t){var e=this;this.context&&(this.currentMusic?(this.muted||(this.musicFaderGain.gain.setValueAtTime(this.musicFaderGain.gain.value,this.context.currentTime),this.musicFaderGain.gain.linearRampToValueAtTime(0,this.context.currentTime+this.musicFade)),setTimeout((function(){e.playMusic(t)}),1e3*this.musicFade)):this.playMusic(t))},t.prototype.getCurrentMusic=function(){return this.currentMusicId},t.prototype.isInitialized=function(){return this.initialized},t.prototype.pauseAll=function(){this.playingSounds.forEach((function(t){t.pause()}))},t.prototype.playMusic=function(t,e){if(this.context){if(this.currentMusic&&this.stopMusic(!1),!t)return;var i=this.sounds[t];void 0===e&&(e=i.getLoopsByDefaultIfMusic()),this.musicFaderGain=this.context.createGain(),this.musicFaderGain.gain.setValueAtTime(1,this.context.currentTime),this.musicFaderGain.gain.value=1,this.currentMusic=this.context.createBufferSource(),this.currentMusic.loop=e,this.musicLoopStart=i.getLoopStart()||0,this.currentMusic.loopStart=this.musicLoopStart,this.currentMusic.buffer=i.getBuffer(),this.currentMusic.loopEnd=this.currentMusic.buffer.duration,this.currentMusic.connect(this.musicFaderGain),this.musicFaderGain.connect(this.volumeFaderGain),this.currentMusic.start(0),this.currentMusicId=t,console.log("Just started new music with id: "+t+", loop: "+e)}},t.prototype.playSound=function(t,e,i){if(void 0===e&&(e=!1),this.context){var o=this.createPlayingSound(t,e,0,i);return this.playingSounds.push(o),o.start(),o.id}return-1},t.prototype.removePlayingSound=function(t){for(var e=0;e<this.playingSounds.length;e++)if(this.playingSounds[e].id===t){var i=this.playingSounds[e];return this.playingSounds.splice(e,1),i}return null},t.prototype.resumeAll=function(){for(var t=0;t<this.playingSounds.length;t++){var e=this.playingSounds[t];e.isPaused()&&e.resume()}},t.prototype.stopMusic=function(t){void 0===t&&(t=!1),this.currentMusic&&(this.currentMusic.stop(),t||(this.currentMusic.disconnect(),this.musicFaderGain.disconnect(),delete this.currentMusic,delete this.musicFaderGain))},t.prototype.stopSound=function(t){var e=this.removePlayingSound(t);return!(!e||!e.source||(e.source.stop(),0))},t.prototype.toggleMuted=function(){if(this.muted=!this.muted,this.context){var t=this.muted?0:1;this.volumeFaderGain.gain.setValueAtTime(t,this.context.currentTime),this.volumeFaderGain.gain.value=t}return this.muted},Object.defineProperty(t.prototype,"fadeMusic",{get:function(){return this.doFadeMusic},set:function(t){this.doFadeMusic=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"musicFadeSeconds",{get:function(){return this.musicFade},set:function(t){this.musicFade=t},enumerable:!0,configurable:!0}),t}();e.default=o},5410:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},o(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(e,i,o,s,n,r){return void 0===r&&(r=1),t.call(this,e,i,o,s,n,r)||this}return s(e,t),e.prototype.drawString=function(t,e,i){for(var o=this.size,s=window.game.canvas.getContext("2d"),n=this.cellW,r=0;r<t.length;r++){var a=t.charCodeAt(r)-32;(a<0||a>=o)&&(a=0),this.drawByIndex(s,e,i,a),e+=n}},e}(i(1761).default);e.default=n},2011:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={getWindowLocationSearch:function(){return window.location.search}}},7114:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(2377);e.default={resize:function(t,e){switch(e){default:case o.StretchMode.STRETCH_NONE:t.style.width=t.width+"px",t.style.height=t.height+"px";break;case o.StretchMode.STRETCH_FILL:t.style.width=document.body.clientWidth+"px",t.style.height=document.body.clientHeight+"px";break;case o.StretchMode.STRETCH_PROPORTIONAL:var i=document.body.clientWidth/(1*t.width),s=document.body.clientHeight/(1*t.height),n=Math.min(i,s);t.style.width=Math.floor(t.width*n)+"px",t.style.height=Math.floor(t.height*n)+"px"}}}},2539:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){if(!t||!t.millis)throw'Missing required "millis" argument to Delay';this.initial=Array.isArray(t.millis)?t.millis:[t.millis],this.initialIndex=0,t.minDelta&&t.maxDelta&&this.setRandomDelta(t.minDelta,t.maxDelta),this.callback=t.callback,this.loop=!!t.loop,this.loopCount=0,this.maxLoopCount=this.loop&&t.loopCount||-1,this.remaining=0,this.curInitial=0,this.reset()}return t.prototype.update=function(t){return this.remaining>0&&(this.remaining-=t,this.remaining<=0&&this.callback&&this.callback(this)),this.remaining<=0&&(this.loop?-1===this.maxLoopCount||this.loopCount<this.maxLoopCount-1?(this.loopCount++,this.reset(!0)):(this.loopCount=this.maxLoopCount,this.remaining=-1):this.remaining=Math.max(0,this.remaining)),this.isDone()},t.prototype.getLoopCount=function(){return this.loopCount},t.prototype.getMaxDelta=function(){return void 0!==this.maxDelta?this.maxDelta:-1},t.prototype.getMinDelta=function(){return void 0!==this.minDelta?this.minDelta:-1},t.prototype.getRemaining=function(){return this.remaining},t.prototype.getRemainingPercent=function(){return this.remaining/this.curInitial},t.prototype.isDone=function(){return(!this.loop||this.loopCount===this.maxLoopCount)&&this.remaining<=0},t.prototype.setRandomDelta=function(t,e){this.minDelta=t,this.maxDelta=e},t.prototype.reset=function(t){t=!!t;var e=this.remaining;this.curInitial=this.remaining=this.initial[this.initialIndex],t&&e<0&&(this.remaining+=e),this.initialIndex=(this.initialIndex+1)%this.initial.length,this.minDelta||this.maxDelta},t.prototype.toString=function(){return"[Delay: _initial="+this.initial+", _remaining="+this.remaining+", _loop="+this.loop+", _callback="+!!this.callback+"]"},t}();e.default=i},5704:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},o(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(e,i,o,s){var n=t.call(this)||this;return n.leavingState=e,n.enteringState=i,n.transitionLogic=o,n.fadingOut=!0,n.alpha=1,n.halfTime=s&&s>0?s/2:800,n.curTime=0,n}return s(e,t),e.prototype.update=function(e){if(t.prototype.update.call(this,e),this.curTime+=e,this.curTime>=this.halfTime){if(this.curTime-=this.halfTime,!this.fadingOut)return void this._setState(this.enteringState);this.fadingOut=!1,this.transitionLogic&&this.transitionLogic()}this.alpha=this.fadingOut?1-this.curTime/this.halfTime:this.curTime/this.halfTime},e.prototype.render=function(e){t.prototype.render.call(this,e),this.game.clearScreen();var i=e.globalAlpha;e.globalAlpha=this.alpha,this.fadingOut?this.leavingState.render(e):this.enteringState.render(e),e.globalAlpha=i},e.prototype._setState=function(t){this.game.setState(this.enteringState)},e}(i(2467).default);e.default=n},118:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(2860),s=i(2098),n=i(9879),r=i(2879),a=i(7927),h=i(9336),u=i(9107),c=i(6594),l=function(){function t(t){void 0===t&&(t={width:640,height:480}),h.default.initConsole(),this.scale=t.scale||1,this.canvas=a.default.createCanvas(t.width,t.height,t.parent),this.inputManager=new s.default(t.keyRefreshMillis||0),this.inputManager.install(),this.targetFps=t.targetFps||30,this.interval=1e3/this.targetFps,this.lastTime=0,this.audio=new u.default,this.audio.init();var e=t.assetRoot;this.assets=new c.default(this.scale,this.audio,e),this.clearScreenColor="rgb(0,0,0)",this.fpsColor="rgb(255,255,255)",this.statusMessageRGB="255,255,255",this.statusMessageColor=null,this.showFps=!1,this.frames=0,this.fpsMsg=this.targetFps+" fps",this.statusMessage=null,this.statusMessageAlpha=0,this.statusMessageTime=0,this.gameTimer=new n.GameTimer,this.timer=new r.default}return t.prototype.clearScreen=function(t){void 0===t&&(t=this.clearScreenColor);var e=this.canvas.getContext("2d");e.fillStyle=t,e.fillRect(0,0,this.getWidth(),this.getHeight())},t.prototype.getHeight=function(){return this.canvas.height},t.prototype.getWidth=function(){return this.canvas.width},Object.defineProperty(t.prototype,"paused",{get:function(){return this.gameTimer.paused},set:function(t){t?this.audio.pauseAll():this.audio.resumeAll(),this.gameTimer.paused=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playTime",{get:function(){return this.gameTimer.playTime},enumerable:!0,configurable:!0}),t.prototype.randomInt=function(t){return Math.floor(Math.random()*(t-0+1)+0)},t.prototype.render=function(){var t=this.canvas.getContext("2d");this.state.render(t),this.showFps&&this._renderFps(t),this.statusMessage&&this.statusMessageAlpha>0&&this._renderStatusMessage(t)},t.prototype._renderFps=function(t){this.frames++;var e=h.default.timestamp();e-this.lastTime>=1e3&&(this.fpsMsg=this.frames+" fps",this.frames=0,this.lastTime=e),t.font="10pt Arial",t.fillStyle=this.fpsColor,t.fillText(this.fpsMsg,10,15)},t.prototype._renderStatusMessage=function(t){if(this.statusMessage){var e=this.canvas.height-6;t.font="10pt Arial",t.fillStyle=this.statusMessageColor||"#fff",t.fillText(this.statusMessage,10,e)}},t.prototype.resetPlayTime=function(){this.gameTimer.resetPlayTime()},t.prototype.setState=function(t){this.state&&this.state.leaving(this),this.state=t,this.state.enter(this)},t.prototype.setStatusMessage=function(t){this.statusMessage=t,this.statusMessageAlpha=2,this.statusMessageTime=h.default.timestamp()+100},t.prototype.start=function(){var t=this._tick.bind(this);this.gameTimer.start(),setInterval(t,this.interval)},t.prototype._tick=function(){if(this.statusMessage){var t=h.default.timestamp();if(t>this.statusMessageTime){this.statusMessageTime=t+100,this.statusMessageAlpha-=.1;var e=Math.min(1,this.statusMessageAlpha);this.statusMessageColor="rgba("+this.statusMessageRGB+","+e+")",this.statusMessageAlpha<=0&&(this.statusMessage=null)}}this.update(),this.render()},t.prototype.toggleMuted=function(){var t=this.audio.toggleMuted();return this.setStatusMessage(t?"Audio muted":"Audio enabled"),t},t.prototype.toggleShowFps=function(){this.showFps=!this.showFps,this.setStatusMessage("FPS display: "+(this.showFps?"on":"off"))},t.prototype.update=function(){var t=this.inputManager;t.isKeyDown(o.Keys.KEY_SHIFT)&&t.isKeyDown(o.Keys.KEY_F,!0)&&this.toggleShowFps(),this.state.update(this.interval)},t}();e.default=l},9879:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(9336),s=function(){function t(){this.isPaused=!1,this.pauseStart=0,this.isUpdating=!0,this.notUpdatingStart=0,this.startShift=0}return Object.defineProperty(t.prototype,"paused",{get:function(){return this.isPaused},set:function(t){if(this.isPaused!==t)if(this.isPaused=t,t)this.pauseStart=o.default.timestamp();else{var e=o.default.timestamp()-this.pauseStart;this.startShift+=e,this.pauseStart=0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playTime",{get:function(){return 0!==this.pauseStart?this.pauseStart-this.startShift:0!==this.notUpdatingStart?this.notUpdatingStart-this.startShift:o.default.timestamp()-this.startShift},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating},set:function(t){if(this.isUpdating!==t&&(this.isUpdating=t,!this.paused))if(this.isUpdating){var e=o.default.timestamp()-this.notUpdatingStart;this.startShift+=e,this.notUpdatingStart=0}else this.notUpdatingStart=o.default.timestamp()},enumerable:!0,configurable:!0}),t.prototype.resetPlayTime=function(){if(this.paused||!this.updating)throw"Cannot reset playtime millis when paused or not updating";this.startShift=o.default.timestamp()},t.prototype.start=function(){this.startShift=o.default.timestamp()},t}();e.GameTimer=s},5498:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(7927),s=function(){function t(t,e,i,s,n){void 0!==e&&void 0!==i&&void 0!==s&&void 0!==n?(this.x=e,this.y=i,this.w=s,this.h=n):(this.x=this.y=0,this.w=t.width,this.h=t.height),this.canvas=o.default.ensure256Square(t)}return t.prototype.draw=function(t,e,i){o.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i)),t.drawImage(this.canvas,this.x,this.y,this.w,this.h,e,i,this.w,this.h)},t.prototype.drawScaled=function(t,e,i,s,n){o.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i)),t.drawImage(this.canvas,this.x,this.y,this.w,this.h,e,i,s,n)},t.prototype.drawScaled2=function(t,e,i,s,n,r,a,h,u){o.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i),r=Math.round(r),a=Math.round(a)),e=this.x+e,i=this.y+i,t.drawImage(this.canvas,e,i,s,n,r,a,h,u)},t.prototype.makeColorTranslucent=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),o.default.makeColorTranslucent(this.canvas,t,e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.w},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.h},enumerable:!0,configurable:!0}),t}();e.default=s},8065:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(5498),s=i(7927),n=function(){function t(t,e){this.atlasInfo=e,this.masterCanvas=t,this.atlasInfo.firstPixelIsTranslucent&&(this.masterCanvas=s.default.makeColorTranslucent(this.masterCanvas))}return t.prototype.parse=function(t){var e=this;void 0===t&&(t=1);var i={};return this.atlasInfo.images.forEach((function(s){var n,r,a,h,u=s.id;if(s.dim){var c=s.dim.split(/,\s*/);if(4!==c.length)throw new Error("Invalid value for imgInfo "+u+"'s dim: "+s.dim);n=parseInt(c[0],10),r=parseInt(c[1],10),a=parseInt(c[2],10),h=parseInt(c[3],10)}else if(n="number"==typeof s.x?s.x:-1,r="number"==typeof s.y?s.y:-1,"number"==typeof s.s?a=h=s.s:(a="number"==typeof s.w?s.w:-1,h="number"==typeof s.h?s.h:-1),n<0||r<0||a<0||h<0)throw new Error("x, y, w, h (or s) not specified for imgInfo: "+JSON.stringify(s));1!==t&&(n*=t,r*=t,a*=t,h*=t),i[u]=new o.default(e.masterCanvas,n,r,a,h)})),i},t}();e.default=n},7927:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=256,o=function(){function t(){}return t.resize=function(e,i){var o,s;if(void 0===i&&(i=1),e instanceof HTMLImageElement?(s=(o=t.createCanvas(e.width,e.height)).getContext("2d")).drawImage(e,0,0):s=(o=e).getContext("2d"),1===i)return o;for(var n=s.getImageData(0,0,e.width,e.height),r=e.width*i,a=e.height*i,h=t.createCanvas(r,a),u=h.getContext("2d"),c=u.getImageData(0,0,r,a),l=0;l<a;l++)for(var d=0;d<r;d++){var p=4*(Math.floor(l/i)*e.width+Math.floor(d/i)),f=4*(l*r+d);c.data[f]=n.data[p],c.data[f+1]=n.data[p+1],c.data[f+2]=n.data[p+2],c.data[f+3]=n.data[p+3]}return u.putImageData(c,0,0),h},t.createCanvas=function(e,i,o){var s=document.createElement("canvas");if(s.width=e,s.height=i,t.prepCanvas(s),o){var n="string"==typeof o?document.getElementById(o):o;n.innerHTML="",n.appendChild(s)}return s},t.ensure256Square=function(e){if(e.width<i||e.height<i){var o=Math.max(i,e.width),s=Math.max(i,e.height),n=t.createCanvas(o,s);n.getContext("2d").drawImage(e,0,0),e=n}return e},t.prepCanvas=function(t){var e=t.getContext("2d");e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.oImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1},t.makeColorTranslucent=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var o=t.getContext("2d"),s=t.width,n=t.height,r=o.getImageData(0,0,s,n),a=[],h=4*(i*s+e),u=0;u<4;u++)a[u]=r.data[h+u];for(i=0;i<n;i++)for(e=0;e<s;e++){var c=4*(i*s+e);r.data[c]===a[0]&&r.data[c+1]===a[1]&&r.data[c+2]===a[2]&&r.data[c+3]===a[3]&&(r.data[c]=0,r.data[c+1]=0,r.data[c+2]=0,r.data[c+3]=0)}return o.putImageData(r,0,0),t},t.allowSubpixelImageRendering=!1,t}();e.default=o},2098:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(2860),s=function(){function t(t){void 0===t&&(t=0),this.keys=[],this.refireMillis=t,this.repeatTimers=[]}return t.prototype.clearKeyState=function(t){this.keys[t]=!1,this.repeatTimers[t]&&(clearInterval(this.repeatTimers[t]),delete this.repeatTimers[t])},t.prototype.clearKeyStates=function(){for(var t=0;t<this.keys.length;t++)this.clearKeyState(t)},t.prototype.ctrl=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_CTRL,t)},t.prototype.down=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_DOWN_ARROW,t)},t.prototype.enter=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_ENTER,t)},t.prototype.install=function(){var t=this;document.onkeydown=function(e){t._keyDown(e)},document.onkeyup=function(e){t._keyUp(e)}},t.prototype.isKeyDown=function(t,e){void 0===e&&(e=!1);var i=this.keys[t];return i&&e&&(this.keys[t]=!1),i},t.prototype._keyDown=function(t){var e=this,i=t.keyCode;(32===i||i>=37&&i<=40)&&t.preventDefault(),this.refireMillis?this.repeatTimers[i]||(this.keys[i]=!0,this.repeatTimers[i]=setInterval((function(){e.keys[i]=!0}),this.refireMillis)):this.keys[i]=!0,t.stopPropagation()},t.prototype._keyUp=function(t){var e=t.keyCode;this.refireMillis?this.repeatTimers[e]?(this.keys[e]=!1,clearInterval(this.repeatTimers[e]),delete this.repeatTimers[e]):console.error("_keyUp: Timer does not exist for key: "+e+"!"):this.keys[e]=!1,t.stopPropagation()},t.prototype.left=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_LEFT_ARROW,t)},t.prototype.right=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_RIGHT_ARROW,t)},t.prototype.shift=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_SHIFT,t)},t.prototype.up=function(t){return void 0===t&&(t=!1),this.isKeyDown(o.Keys.KEY_UP_ARROW,t)},t}();e.default=s},2860:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.Keys||(e.Keys={}))[i.KEY_ENTER=13]="KEY_ENTER",i[i.KEY_SHIFT=16]="KEY_SHIFT",i[i.KEY_CTRL=17]="KEY_CTRL",i[i.KEY_SPACE=32]="KEY_SPACE",i[i.KEY_LEFT_ARROW=37]="KEY_LEFT_ARROW",i[i.KEY_UP_ARROW=38]="KEY_UP_ARROW",i[i.KEY_RIGHT_ARROW=39]="KEY_RIGHT_ARROW",i[i.KEY_DOWN_ARROW=40]="KEY_DOWN_ARROW",i[i.KEY_0=48]="KEY_0",i[i.KEY_1=49]="KEY_1",i[i.KEY_2=50]="KEY_2",i[i.KEY_3=51]="KEY_3",i[i.KEY_4=52]="KEY_4",i[i.KEY_5=53]="KEY_5",i[i.KEY_6=54]="KEY_6",i[i.KEY_7=55]="KEY_7",i[i.KEY_8=56]="KEY_8",i[i.KEY_9=57]="KEY_9",i[i.KEY_A=65]="KEY_A",i[i.KEY_B=66]="KEY_B",i[i.KEY_C=67]="KEY_C",i[i.KEY_D=68]="KEY_D",i[i.KEY_E=69]="KEY_E",i[i.KEY_F=70]="KEY_F",i[i.KEY_G=71]="KEY_G",i[i.KEY_H=72]="KEY_H",i[i.KEY_I=73]="KEY_I",i[i.KEY_J=74]="KEY_J",i[i.KEY_K=75]="KEY_K",i[i.KEY_L=76]="KEY_L",i[i.KEY_M=77]="KEY_M",i[i.KEY_N=78]="KEY_N",i[i.KEY_O=79]="KEY_O",i[i.KEY_P=80]="KEY_P",i[i.KEY_Q=81]="KEY_Q",i[i.KEY_R=82]="KEY_R",i[i.KEY_S=83]="KEY_S",i[i.KEY_T=84]="KEY_T",i[i.KEY_U=85]="KEY_U",i[i.KEY_V=86]="KEY_V",i[i.KEY_W=87]="KEY_W",i[i.KEY_X=88]="KEY_X",i[i.KEY_Y=89]="KEY_Y",i[i.KEY_Z=90]="KEY_Z"},1973:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.equals=function(t){return!!t&&this.x===t.x&&this.y===t.y},t}();e.default=i},7683:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,i){void 0===e&&(e=20),void 0===i&&(i=10),this.c=t,this.pool=[];for(var o=0;o<e;o++)this.pool.push(new this.c);this.index=0,this.growCount=i}return t.prototype.borrowObj=function(){var t=this.pool[this.index++];if(this.index>=this.pool.length)for(var e=0;e<this.growCount;e++)this.pool.push(new this.c);return t},Object.defineProperty(t.prototype,"borrowedCount",{get:function(){return this.index},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.index=0},t.prototype.returnObj=function(t){for(var e=-1,i=0;i<this.index;i++)if(t===this.pool[i]){e=i;break}if(-1===e)return!1;var o=this.pool[--this.index];return this.pool[this.index]=this.pool[e],this.pool[e]=o,!0},Object.defineProperty(t.prototype,"length",{get:function(){return this.pool.length},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"[Pool: borrowed="+this.borrowedCount+", size="+this.length+"]"},t}();e.default=i},36:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,i,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0),this.set(t,e,i,o)}return t.prototype.contains=function(t,e){return t>=this.x&&t<this.x+this.w&&e>=this.y&&e<this.y+this.h},t.prototype.containsRect=function(t,e,i,o){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0),"number"!=typeof t){var s=t;e=s.y,i=s.w,o=s.h,t=s.x}var n=this.w,r=this.h;if((n|r|i|o)<0)return!1;var a=this.x,h=this.y;if(t<a||e<h)return!1;if(n+=a,(i+=t)<=t){if(n>=a||i>n)return!1}else if(n>=a&&i>n)return!1;if(r+=h,(o+=e)<=e){if(r>=h||o>r)return!1}else if(r>=h&&o>r)return!1;return!0},t.prototype.intersects=function(t){var e=this.w,i=this.h,o=t.w,s=t.h;if(o<=0||s<=0||e<=0||i<=0)return!1;var n=this.x,r=this.y,a=t.x,h=t.y;return s+=h,e+=n,i+=r,((o+=a)<a||o>n)&&(s<h||s>r)&&(e<n||e>a)&&(i<r||i>h)},t.prototype.set=function(t,e,i,o){"number"==typeof t?(this.x=t,void 0!==e&&(this.y=e),void 0!==i&&(this.w=i),void 0!==o&&(this.h=o)):(this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h)},t}();e.default=i},5882:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,i){void 0===i&&(i=0),this.id=t,this.buffer=e,this.loopsByDefault=!0,this.loopStart=i}return t.prototype.getBuffer=function(){return this.buffer},t.prototype.getId=function(){return this.id},t.prototype.getLoopsByDefaultIfMusic=function(){return this.loopsByDefault},t.prototype.setLoopsByDefaultIfMusic=function(t){this.loopsByDefault=t},t.prototype.getLoopStart=function(){return this.loopStart},t.prototype.setLoopStart=function(t){this.loopStart=t},t}();e.default=i},1761:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,i,o,s,n){void 0===o&&(o=1),void 0===s&&(s=o),void 0===n&&(n=1),this.gtpImage=t,this.cellW=e,this.cellH=i,this.spacingX=o,this.spacingY=s,1!==n&&(this.cellW*=n,this.cellH*=n,this.spacingX*=n,this.spacingY*=n),this.rowCount=Math.floor(t.height/(this.cellH+this.spacingY)),t.height-this.rowCount*(this.cellH+this.spacingY)>=this.cellH&&this.rowCount++,this.colCount=Math.floor(t.width/(this.cellW+this.spacingX)),t.width-this.colCount*(this.cellW+this.spacingX)>=this.cellW&&this.colCount++,this.size=this.rowCount*this.colCount}return t.prototype.drawSprite=function(t,e,i,o,s){var n=this.cellW,r=this.cellH,a=(n+this.spacingX)*s,h=(r+this.spacingY)*o;this.gtpImage.drawScaled2(t,a,h,n,r,e,i,n,r)},t.prototype.drawByIndex=function(t,e,i,o){var s=Math.floor(o/this.colCount),n=Math.floor(o%this.colCount);this.drawSprite(t,e,i,s,n)},t}();e.default=i},2467:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(118),s=function(){function t(t){if(t&&t instanceof o.default)this.game=t;else if(t)this.game=t.game;else{var e=window;this.game=e.game}}return t.prototype.enter=function(t){},t.prototype.leaving=function(t){},t.prototype.update=function(t){},t.prototype.render=function(t){},t}();e.State=s,e.default=s},2377:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.StretchMode||(e.StretchMode={}))[i.STRETCH_NONE=0]="STRETCH_NONE",i[i.STRETCH_FILL=1]="STRETCH_FILL",i[i.STRETCH_PROPORTIONAL=2]="STRETCH_PROPORTIONAL"},2879:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(9336),s=function(){function t(){this.startTimes={},this.prefix="DEBUG"}return t.prototype.setLogPrefix=function(t){void 0===t&&(t="DEBUG"),this.prefix=t},t.prototype.start=function(t){this.startTimes[t]=o.default.timestamp()},t.prototype.end=function(t){var e=this.startTimes[t];if(!e)return console.error('Cannot end timer for "'+t+'" as it was never started'),-1;var i=o.default.timestamp()-e;return delete this.startTimes[t],i},t.prototype.endAndLog=function(t){var e=this.end(t);e>-1&&console.log(this.prefix+": "+t+": "+e+" ms")},t}();e.default=s},9336:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(2011);e.default={getObjectSize:function(t){var e=0;for(var i in t)t.hasOwnProperty(i)&&e++;return e},getRequestParam:function(t){var e="&"+o.default.getWindowLocationSearch().substring(1),i="&"+t,s=e.indexOf(i);if(s>=-1){var n=s+i.length;if("="===e.charAt(n)){n++;var r=e.indexOf("&",n);return-1===r&&(r=e.length),e.substring(n,r)}if("&"===e.charAt(n))return"";if(n===e.length)return""}return null},hitch:function(t,e){return function(){e.apply(t,arguments)}},mixin:function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},randomInt:function(t,e){var i,o;return void 0===e?(i=0,o=t):(i=t,o=e),Math.floor(Math.random()*(o-i))+i},timestamp:function(){return window.performance&&window.performance.now?window.performance.now():Date.now()},initConsole:function(){if(!window.console){var t=function(){};window.console={info:t,log:t,warn:t,error:t}}}}},3903:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(6594);e.AssetLoader=o.default;var s=i(2842);e.AssetType=s.AssetType;var n=i(9107);e.AudioSystem=n.default;var r=i(5410);e.BitmapFont=r.default;var a=i(2011);e.BrowserUtil=a.default;var h=i(7114);e.CanvasResizer=h.default;var u=i(2539);e.Delay=u.default;var c=i(5704);e.FadeOutInState=c.default;var l=i(118);e.Game=l.default;var d=i(5498);e.Image=d.default;var p=i(8065);e.ImageAtlas=p.default;var f=i(7927);e.ImageUtils=f.default;var g=i(2098);e.InputManager=g.default;var m=i(2860);e.Keys=m.Keys;var y=i(1973);e.Point=y.default;var _=i(7683);e.Pool=_.default;var S=i(36);e.Rectangle=S.default;var v=i(5882);e.Sound=v.default;var T=i(1761);e.SpriteSheet=T.default;var E=i(2467);e.State=E.State;var b=i(2377);e.StretchMode=b.StretchMode;var I=i(2879);e.Timer=I.default;var w=i(9336);e.Utils=w.default;var O=i(2036);e.TiledLayer=O.default;var P=i(1422);e.TiledMap=P.default;var M=i(6564);e.TiledObject=M.default;var A=i(9950);e.TiledTileset=A.default},2036:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(6564),s=function(){function t(t,e){this.map=t,this.name=e.name,this.width=e.width,this.height=e.height,this.data=e.data,this.opacity=e.opacity,this.visible=e.visible,this.type=e.type,this.x=e.x,this.y=e.y,this.setObjects(e.objects)}return t.prototype.getData=function(t,e){if(!this.data)return-1;var i=this._getIndex(t,e);return this.data[i]},t.prototype.setData=function(t,e,i){if(!this.data)return!1;var o=this._getIndex(t,e);return this.data[o]=i,!0},t.prototype._getIndex=function(t,e){return t*this.map.colCount+e},t.prototype.getObjectByName=function(t){return this.objectsByName?this.objectsByName[t]:null},t.prototype.getObjectIntersecting=function(t,e,i,o){if(this.objects)for(var s=0;s<this.objects.length;s++){var n=this.objects[s];if(n.intersects(t,e,i,o))return n}return null},t.prototype.isObjectGroup=function(){return"objectgroup"===this.type},t.prototype.setObjects=function(t){if(t){this.objects=[],this.objectsByName={};for(var e=0;e<t.length;e++){var i=new o.default(t[e]);this.objects.push(i),this.objectsByName[t[e].name]=i}}},t}();e.default=s},1422:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=i(9950),s=i(2036),n=function(){function t(t,e){var i=this;this.rowCount=t.height,this.colCount=t.width,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.screenWidth=e.screenWidth,this.screenHeight=e.screenHeight,this.screenRows=Math.ceil(this.screenHeight/this.tileHeight),this.screenCols=Math.ceil(this.screenWidth/this.tileWidth);var s=e?e.imagePathModifier:null;this.layers=[],this.layersByName={},this.objectGroups=[];for(var n=0;n<t.layers.length;n++)this.addLayer(t.layers[n]);if(this.tilesets=[],t.tilesets&&t.tilesets.length)for(n=0;n<t.tilesets.length;n++)this.tilesets.push(new o.default(t.tilesets[n],s));this.properties=t.properties||[],this.version=t.version,this.orientation=t.orientation,this.propertiesByName={},this.properties.forEach((function(t){i.propertiesByName[t.name]=t}))}return t.prototype.addLayer=function(t){var e=new s.default(this,t);this.layers.push(e),this.layersByName[e.name]=e,e.isObjectGroup()&&this.objectGroups.push(e)},t.prototype.draw=function(t,e,i,o,s){void 0===o&&(o=0),void 0===s&&(s=0);var n=this.colCount,r=this.rowCount,a=this.screenRows,h=this.screenCols,u=this.tileWidth,c=this.tileHeight,l=u,d=this.screenWidth,p=this.screenHeight,f=i-Math.floor(a/2);f<0&&(f+=n);var g=e-Math.floor(h/2);g<0&&(g+=r);var m=i*u+o+u/2-d/2,y=e*c+s+c/2-p/2,_=Math.floor(m/u);m%l<0&&_--;var S=_*u,v=Math.floor(y/c);y%l<0&&v--;var T=S-m,E=T,b=v*c-y;_<0&&(_+=n),v<0&&(v+=r);for(var I=v,w=this.getLayerCount();b<p;){for(var O=0;O<w;O++){var P=_;E=T;var M=this.getLayerByIndex(O);if(M.visible){var A=1;for(M.opacity<1&&(A=t.globalAlpha,t.globalAlpha=A*M.opacity);E<d;){var C=M.getData(I%r,P%n);this.drawTile(t,E,b,C,M),E+=u,P++}M.opacity<1&&(t.globalAlpha=A)}}b+=c,I++}},t.prototype.getLayer=function(t){return this.layersByName[t]},t.prototype.getLayerByIndex=function(t){return this.layers[t]},t.prototype.getLayerCount=function(){return this.layers.length},t.prototype._getImageForGid=function(t){for(var e=this.tilesets.length,i=0;i<e;i++)if(this.tilesets[i].firstgid>t)return this.tilesets[i-1];return this.tilesets[e-1]},t.prototype.getProperty=function(t){return this.propertiesByName[t]?this.propertiesByName[t].value:null},t.prototype.drawTile=function(t,e,i,o,s){if(!(o<=0)){var n=this._getImageForGid(o);if(n){if(!((o-=n.firstgid)<0)){var r=window.game.assets.getTmxTilesetImage(n),a=this.tileWidth,h=a+n.spacing,u=this.tileHeight,c=u+n.spacing,l=Math.floor(r.width/h);n.spacing>0&&r.width%h===a&&l++;var d=Math.floor(o/l)*c,p=o%l*h;r.drawScaled2(t,p,d,a,u,e,i,a,u)}}else console.log("null tileset for: "+o+" (layer "+s.name+")")}},t.prototype.setScale=function(t){this.tileWidth*=t,this.tileHeight*=t,this.screenRows=Math.ceil(this.screenHeight/this.tileHeight),this.screenCols=Math.ceil(this.screenWidth/this.tileWidth);for(var e=this.tilesets.length,i=0;i<e;i++)this.tilesets[i].setScale(t)},t.prototype.getPixelWidth=function(){return this.colCount*this.tileWidth},t.prototype.getPixelHeight=function(){return this.rowCount*this.tileHeight},t.prototype.removeLayer=function(t){for(var e=0;e<this.layers.length;e++){if(this.layers[e].name===t){this.layers.splice(e,1),delete this.layersByName[t];for(var i=0;i<this.objectGroups.length;i++)this.objectGroups[i].name===t&&delete this.objectGroups[i]}return!0}return!1},t}();e.default=n},6564:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){var e=this;this.gid=t.gid||-1,this.name=t.name,this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.type=t.type,this.visible=void 0===t.visible||t.visible,this.properties=t.properties||[];var i=window.game;this.x*=i.scale,this.y*=i.scale,this.width*=i.scale,this.height*=i.scale,this.propertiesByName={},this.properties.forEach((function(t){e.propertiesByName[t.name]=t}))}return t.prototype.getProperty=function(t){return this.propertiesByName[t]?this.propertiesByName[t].value:null},t.prototype.intersects=function(t,e,i,o){var s=this.width,n=this.height,r=i,a=o;if(r<=0||a<=0||s<=0||n<=0)return!1;var h=this.x,u=this.y;return a+=e,s+=h,n+=u,((r+=t)<t||r>h)&&(a<e||a>u)&&(s<h||s>t)&&(n<u||n>e)},t}();e.default=i},9950:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this.firstgid=t.firstgid,this.image=t.image,e&&(this.image=e(this.image)),this.imageWidth=t.imagewidth,this.imageHeight=t.imageheight,this.margin=t.margin,this.name=t.name,this.properties=t.properties,this.spacing=t.spacing,this.tileWidth=t.tilewidth,this.tileHeight=t.tileheight}return t.prototype.setScale=function(t){this.imageWidth*=t,this.imageHeight*=t,this.tileWidth*=t,this.tileHeight*=t,this.margin*=t,this.spacing*=t},t}();e.default=i},603:(t,e,i)=>{i.r(e)},3164:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});const o="<!doctype html>\n<html>\n\n<head>\n   <title>Pacman</title>\n   <meta charset=\"UTF-8\">\n   <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>\n\n    <script>\n        window.onload = function() {\n            init('parent');\n        };\n    <\/script>\n\n</head>\n\n<body>\n\n  <div class='content'>\n\n    <h1>Pacman in your browser!</h1>\n\n    <div id='parent'></div>\n\n    <div class='panel'>\n\n      <div class='panel-header'>\n        <h3>How to Play</h3>\n      </div>\n\n      <div class='info'>\n\n        <h4>Controls:</h4>\n        <ol>\n          <li><b>Enter:</b> Start game / Pause\n          <li><b>Arrow Keys:</b> Move around\n          <li><b>M:</b> Toggle sound (mute)\n        </ol>\n\n        <h4>Cheats:</h4>\n        <ul>\n          <li><b>Z + X</b>: Next level\n          <li><b>Z + C</b>: Commit suicide\n          <li><b>Z + G</b>: Toggle God Mode\n        </ul>\n\n      </div>\n\n      <div class='panel-footer'>\n        Build date: <%=build.date%>\n      </div>\n    </div>\n\n  </div>\n</body>\n\n</html>\n"},755:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Blinky=void 0;var n=i(6844),r=i(5717),a=i(4822),h=function(t){function e(e){return t.call(this,e,0*a.default.SPRITE_SIZE,0)||this}return s(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=r.Direction.WEST,this.setLocation(this.game.PENALTY_BOX_EXIT_X,this.game.PENALTY_BOX_EXIT_Y),this.motionState=n.MotionState.SCATTERING},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,o=this.column,s=this.game.pacman.row,a=this.game.pacman.column,h=t.getPathBreadthFirst(i,o,s,a);null==h?this.changeDirectionFallback(t):h.col<o?(this.direction=r.Direction.WEST,this.incX(-e)):h.col>o?(this.direction=r.Direction.EAST,this.incX(e)):h.row<i?(this.direction=r.Direction.NORTH,this.incY(-e)):h.row>i&&(this.direction=r.Direction.SOUTH,this.incY(e))}else this.continueInCurrentDirection(e);this.game.playTime>=this.startScatteringTime&&(this.motionState=n.MotionState.SCATTERING)},e}(n.Ghost);e.Blinky=h},5912:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Clyde=void 0;var n=i(6844),r=i(5717),a=i(4822),h=function(t){function e(e){return t.call(this,e,3*a.default.SPRITE_SIZE,14)||this}return s(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=r.Direction.SOUTH,this.setLocation(16*a.default.TILE_SIZE-a.default.TILE_SIZE/2-4,15*a.default.TILE_SIZE-a.default.TILE_SIZE/2),this.motionState=n.MotionState.IN_BOX},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount;this.atIntersection(t)?this.changeDirectionFallback(t):this.continueInCurrentDirection(e),game.playTime>=this.startScatteringTime&&(this.motionState=n.MotionState.SCATTERING)},e}(n.Ghost);e.Clyde=h},4822:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.SPRITE_SIZE=16,t.TILE_SIZE=8,t}();e.default=i},5717:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Direction=void 0,function(t){t[t.EAST=0]="EAST",t[t.SOUTH=1]="SOUTH",t[t.WEST=2]="WEST",t[t.NORTH=3]="NORTH"}(i=e.Direction||(e.Direction={}));var o={fromString:function(t){switch(void 0===t&&(t="SOUTH"),t.toUpperCase()){case"NORTH":return i.NORTH;case"EAST":return i.EAST;case"WEST":return i.WEST;default:return i.SOUTH}}};e.default=o},10:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Fruit=void 0;var n=i(3190),r=i(4822),a=function(t){function e(){var i=t.call(this,1)||this;i.setLocation(game.PENALTY_BOX_EXIT_X,140);var o=game.level;return o>7&&(o=game.randomInt(8)),i._col=e.COLS[o],i._row=e.ROWS[o],i._pointsIndex=e.PTS_INDEX[o],i}return s(e,t),Object.defineProperty(e.prototype,"pointsIndex",{get:function(){return this._pointsIndex},enumerable:!1,configurable:!0}),e.prototype.getUpdateDelayMillis=function(){return 1e11},e.prototype.paint=function(t){var e=r.default.SPRITE_SIZE,i=this._col*e,o=this._row*e;game.drawSprite(this.x,this.y,i,o)},e.prototype.updatePositionImpl=function(t){},e.COLS=[12,13,12,13,13,12,13,13],e.ROWS=[4,4,5,5,2,6,6,3],e.PTS_INDEX=[0,2,4,5,10,7,9,11],e}(n._BaseSprite);e.Fruit=a},6844:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Ghost=e.MotionState=void 0;var n,r=i(3190),a=i(3903),h=i(5717),u=i(4822);!function(t){t[t.IN_BOX=0]="IN_BOX",t[t.LEAVING_BOX=1]="LEAVING_BOX",t[t.CHASING_PACMAN=2]="CHASING_PACMAN",t[t.SCATTERING=3]="SCATTERING",t[t.BLUE=4]="BLUE",t[t.EYES=5]="EYES",t[t.EYES_ENTERING_BOX=6]="EYES_ENTERING_BOX"}(n=e.MotionState||(e.MotionState={}));var c=function(t){function e(e,i,o){var s=t.call(this,2)||this;return s.game=e,s.corner=new a.Point,s.spriteSheetY=i,s.exitDelaySeconds=o,s.reset(),s}return s(e,t),e.prototype.changeDirectionFallback=function(t){var e=this.moveAmount;switch(a.Utils.randomInt(4)){case 0:this.goUpIfPossible(t,e)||this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||this.goDownIfPossible(t,e);break;case 1:this.goLeftIfPossible(t,e)||this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||this.goRightIfPossible(t,e);break;case 2:this.goDownIfPossible(t,e)||this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||this.goUpIfPossible(t,e);break;case 3:this.goRightIfPossible(t,e)||this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||this.goLeftIfPossible(t,e)}},e.prototype.continueInCurrentDirection=function(t){switch(this.direction){case h.Direction.NORTH:this.incY(-t);break;case h.Direction.WEST:this.incX(-t);break;case h.Direction.SOUTH:this.incY(t);break;case h.Direction.EAST:this.incX(t)}},e.prototype.getBlueTimeForLevel=function(t){switch(t){case 0:case 1:return 8e3;case 2:case 3:return 6e3;case 4:case 5:return 4e3;case 6:case 7:return 2e3;default:return 0}},e.prototype.getFirstExitDelayMillis=function(){return 1e3*this.exitDelaySeconds},e.prototype.getFrameCount=function(){return 2},Object.defineProperty(e.prototype,"motionState",{get:function(){return this._motionState},set:function(t){var e=this.game;if(t===n.SCATTERING)switch(this.scatterCount++){case 0:case 1:this.exitScatteringTime=e.playTime+7e3,this._motionState=t;break;case 2:case 3:this.exitScatteringTime=e.playTime+5e3,this._motionState=t;break;default:this._motionState=n.CHASING_PACMAN}else if(t===n.BLUE){var i=this.getBlueTimeForLevel(e.level),o=e.playTime;switch(this.exitBlueTime=o+i,this._motionState){case n.CHASING_PACMAN:this.previousState=this._motionState,this.startScatteringTime+=i;break;case n.SCATTERING:this.previousState=this._motionState,this.exitScatteringTime+=i;break;case n.BLUE:var s=this.exitBlueTime-o;switch(this.previousState){case n.CHASING_PACMAN:this.startScatteringTime+=s+i;break;case n.SCATTERING:this.exitScatteringTime+=s+i}break;default:throw new Error("Unexpected state: "+this._motionState)}this._motionState=t}else this._motionState===n.CHASING_PACMAN&&(this.startScatteringTime=e.playTime+2e4),this._motionState=t;this.game.checkLoopedSound()},enumerable:!1,configurable:!0}),e.prototype.getUpdateDelayMillis=function(){switch(this._motionState){case n.BLUE:return 25;case n.EYES:case n.EYES_ENTERING_BOX:default:return 10}},e.prototype.isBlue=function(){return this._motionState===n.BLUE},e.prototype.isEyes=function(){return this._motionState===n.EYES||this._motionState===n.EYES_ENTERING_BOX},e.prototype.paint=function(t){var e,i,o=this.bounds.x,s=this.bounds.y,r=u.default.SPRITE_SIZE;switch(this._motionState){case n.BLUE:e=(10+this.getFrame())*r,i=3*r;var a=game.playTime;this.exitBlueTime-a<=1e3&&0!=(a/250&1)&&(i+=r),game.drawSprite(o,s,e,i);break;case n.EYES:case n.EYES_ENTERING_BOX:e=this.direction*r,i=4*r,game.drawSprite(o,s,e,i);break;default:e=this.direction*r*this.getFrameCount()+this.getFrame()*r,i=this.spriteSheetY,game.drawSprite(o,s,e,i)}},e.prototype.possiblyTurnBlue=function(){switch(this._motionState){case n.CHASING_PACMAN:case n.SCATTERING:case n.BLUE:return this._motionState=n.BLUE,!0;default:return!1}},e.prototype.reset=function(){t.prototype.reset.call(this),this.scatterCount=0},e.prototype.setCorner=function(t){this.corner.x=t.x,this.corner.y=t.y},e.prototype.updatePositionBlue=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=game.pacman,o=i.row,s=i.column,n=this.row,r=this.column,a=!1;n===o&&t.isClearShotRow(n,r,s)?(this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||(s<r?this.goRightIfPossible(t,e)||(this.direction=h.Direction.WEST,this.incX(-e)):this.goLeftIfPossible(t,e)||(this.direction=h.Direction.EAST,this.incX(e))),a=!0):r===s&&t.isClearShotColumn(r,n,o)&&(this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||(o<n?this.goDownIfPossible(t,e)||(this.direction=h.Direction.NORTH,this.incY(-e)):this.goUpIfPossible(t,e)||(this.direction=h.Direction.SOUTH,this.incY(e))),a=!0),a||this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.exitBlueTime&&(this._motionState=this.previousState)},e.prototype.updatePositionEyes=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,o=this.column,s=Math.floor((game.PENALTY_BOX_EXIT_Y+8)/u.default.TILE_SIZE),r=Math.floor(game.PENALTY_BOX_EXIT_X/u.default.TILE_SIZE);o<=r&&r++;var a=t.getPathBreadthFirst(i,o,s,r);null==a?this._motionState=n.EYES_ENTERING_BOX:a.col<o?(this.direction=h.Direction.WEST,this.incX(-e)):a.col>o?(this.direction=h.Direction.EAST,this.incX(e)):a.row<i?(this.direction=h.Direction.NORTH,this.incY(-e)):a.row>i&&(this.direction=h.Direction.SOUTH,this.incY(e))}else(i=this.row)===(s=Math.floor((game.PENALTY_BOX_EXIT_Y+8)/u.default.TILE_SIZE))&&this.x===game.PENALTY_BOX_EXIT_X?this._motionState=n.EYES_ENTERING_BOX:this.continueInCurrentDirection(e)},e.prototype.updatePositionEyesEnteringBox=function(t){this.y<game.PENALTY_BOX_EXIT_Y+3*u.default.SPRITE_SIZE/2?(this.direction=h.Direction.SOUTH,this.incY(.5)):this._motionState=n.LEAVING_BOX},e.prototype.updatePositionImpl=function(t){switch(this._motionState){case n.IN_BOX:this.updatePositionInBox(t);break;case n.LEAVING_BOX:this.updatePositionLeavingBox(t);break;case n.SCATTERING:this.updatePositionScattering(t);break;case n.CHASING_PACMAN:this.updatePositionChasingPacman(t);break;case n.BLUE:this.updatePositionBlue(t);break;case n.EYES:this.updatePositionEyes(t);break;case n.EYES_ENTERING_BOX:this.updatePositionEyesEnteringBox(t)}},e.prototype.updatePositionInBox=function(t){switch(this.direction){case h.Direction.WEST:case h.Direction.NORTH:this.y>112?this.incY(-.5):this.direction=h.Direction.SOUTH;break;case h.Direction.EAST:case h.Direction.SOUTH:this.y<120?this.incY(.5):this.direction=h.Direction.NORTH}game.playTime>=this.getFirstExitDelayMillis()&&(this._motionState=n.LEAVING_BOX)},e.prototype.updatePositionLeavingBox=function(t){var e=this.x;if(e<game.PENALTY_BOX_EXIT_X)this.direction=h.Direction.EAST,this.incX(.5);else if(e>game.PENALTY_BOX_EXIT_X)this.direction=h.Direction.WEST,this.incX(-.5);else{var i=this.y-.5;this.y=i,i<=game.PENALTY_BOX_EXIT_Y?(i=game.PENALTY_BOX_EXIT_Y,this._motionState=n.SCATTERING,this.direction=h.Direction.WEST):this.direction=h.Direction.NORTH}},e.prototype.updatePositionScattering=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,o=this.column,s=this.corner.x,r=this.corner.y,a=t.getPathBreadthFirst(i,o,s,r);a?a.col<o?(this.direction=h.Direction.WEST,this.incX(-e)):a.col>o?(this.direction=h.Direction.EAST,this.incX(e)):a.row<i?(this.direction=h.Direction.NORTH,this.incY(-e)):a.row>i&&(this.direction=h.Direction.SOUTH,this.incY(e)):this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.exitScatteringTime&&(this._motionState=n.CHASING_PACMAN)},e}(r._BaseSprite);e.Ghost=c},8403:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Inky=void 0;var n=i(6844),r=i(5717),a=i(4822),h=function(t){function e(e){return t.call(this,e,1*a.default.SPRITE_SIZE,8)||this}return s(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=r.Direction.SOUTH,this.setLocation(12*a.default.TILE_SIZE-a.default.TILE_SIZE/2-4,15*a.default.TILE_SIZE-a.default.TILE_SIZE/2),this.motionState=n.MotionState.IN_BOX},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,o=this.column,s=game.getGhost(0),a=s.row,h=s.column;if((h-o)*(h-o)+(a-i)*(a-i)<=35){var u=game.pacman.row,c=game.pacman.column,l=t.getPathBreadthFirst(i,o,u,c);null==l?this.changeDirectionFallback(t):l.col<o?(this.direction=r.Direction.WEST,this.incX(-e)):l.col>o?(this.direction=r.Direction.EAST,this.incX(e)):l.row<i?(this.direction=r.Direction.NORTH,this.incY(-e)):l.row>i&&(this.direction=r.Direction.SOUTH,this.incY(e))}else this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.startScatteringTime&&(this.motionState=n.MotionState.SCATTERING)},e}(n.Ghost);e.Inky=h},81:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.LoadingState=void 0;var n=i(1510),r=i(5686),a=i(837),h=i(3903),u=i(2666),c=function(t){function e(e){var i=t.call(this,e)||this;return i.assetsLoaded=!1,i}return s(e,t),e.prototype.update=function(t){var e=this;if(this.handleDefaultKeys(),!this.assetsLoaded){this.assetsLoaded=!0;var i=this.game;i.assets.addImage("loading","res/loadingMessage.png"),i.assets.onLoad((function(){i.assets.addImage("title","res/title.png"),i.assets.addSpriteSheet("font","res/font.png",9,7,0,0),i.assets.addImage("sprites","res/sprite_tiles.png",!0),i.assets.addSpriteSheet("mapTiles","res/map_tiles.png",8,8,0,0),i.assets.addSpriteSheet("points","res/points.png",18,9,0,0),i.assets.addJson("levels","res/levelData.json"),i.assets.addSound(r.default.CHASING_GHOSTS,"res/sounds/chasing_ghosts.wav"),i.assets.addSound(r.default.CHOMP_1,"res/sounds/chomp_1.wav"),i.assets.addSound(r.default.CHOMP_2,"res/sounds/chomp_2.wav"),i.assets.addSound(r.default.DIES,"res/sounds/dies.wav"),i.assets.addSound(r.default.EATING_FRUIT,"res/sounds/eating_fruit.wav"),i.assets.addSound(r.default.EATING_GHOST,"res/sounds/eating_ghost.wav"),i.assets.addSound(r.default.EXTRA_LIFE,"res/sounds/extra_life.wav"),i.assets.addSound(r.default.EYES_RUNNING,"res/sounds/eyes_running.wav"),i.assets.addSound(r.default.INTERMISSION,"res/sounds/intermission.wav"),i.assets.addSound(r.default.OPENING,"res/sounds/opening.wav"),i.assets.addSound(r.default.SIREN,"res/sounds/siren.wav"),i.assets.addSound(r.default.TOKEN,"res/sounds/token.wav"),i.assets.onLoad((function(){(0,u.fixLevelDatas)(i.assets.get("levels")),null!==h.Utils.getRequestParam("skipTitle")?e.game.startGame(0):i.setState(new h.FadeOutInState(e,new a.TitleState))}))}))}},e}(n._BaseState);e.LoadingState=c},6296:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Maze=void 0;var o=i(3903),s=i(4238),n=i(4822),r=[50,10],a=function(){function t(t){this.closed=[],this.open=[],this.goalNode=new s.MazeNode,this.data=[],this.reset(t)}return t._cloneObjectOfPrimitives=function(t){return JSON.parse(JSON.stringify(t))},t.prototype.checkForDot=function(e,i){var o=0,s=this.getTileAt(e,i);return s>=254&&(game.playChompSound(),254===s&&game.makeGhostsBlue(),this.eatenDotCount++,this.data[e][i]=0,o=r[s-254],this.eatenDotCount===t.FRUIT_DOT_COUNT&&game.addFruit(),this.eatenDotCount===this.dotCount&&game.loadNextLevel()),o},t._constructPath=function(t){for(var e=null;t.parent;)e=t,t=t.parent;return e},Object.defineProperty(t,"FRUIT_DOT_COUNT",{get:function(){return 64},enumerable:!1,configurable:!0}),t._getNextColumn=function(e){return++e===t.TILE_COUNT_HORIZONTAL&&(e=0),e},t.prototype.getPathBreadthFirst=function(e,i,o,n){var r=this;this.open.forEach((function(t){r.data[t.row][t.col]&=255})),this.closed.forEach((function(t){r.data[t.row][t.col]&=255})),this.open.length=0,this.closed.length=0,this.goalNode.set(o,n,null);var a=this.nodeCache.borrowObj();for(this.open.push(new s.MazeNode(e,i)),this.data[e][i]|=256;this.open.length>0;){var h=this.open.splice(0,1)[0];if(h.equals(this.goalNode))return this.data[h.row][h.col]&=255,t._constructPath(h);this.closed.push(h),this.isWalkable(h.row-1,h.col)&&0==(256&this.data[h.row-1][h.col])&&(this.data[h.row-1][h.col]|=256,a.set(h.row-1,h.col,h),this.open.push(a),a=this.nodeCache.borrowObj()),this.isWalkable(h.row+1,h.col)&&0==(256&this.data[h.row+1][h.col])&&(this.data[h.row+1][h.col]|=256,a.set(h.row+1,h.col,h),this.open.push(a),a=this.nodeCache.borrowObj());var u=t._getPreviousColumn(h.col);this.isWalkable(h.row,u)&&0==(256&this.data[h.row][u])&&(this.data[h.row][u]|=256,a.set(h.row,u,h),this.open.push(a),a=this.nodeCache.borrowObj()),u=t._getNextColumn(h.col),this.isWalkable(h.row,u)&&0==(256&this.data[h.row][u])&&(this.data[h.row][u]|=256,a.set(h.row,u,h),this.open.push(a),a=this.nodeCache.borrowObj())}throw new Error("No path found from ("+e+", "+i+") to ("+o+", "+n+")")},t._getPreviousColumn=function(e){return 0===e&&(e=t.TILE_COUNT_HORIZONTAL),e-1},Object.defineProperty(t,"TILE_COUNT_HORIZONTAL",{get:function(){return 28},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TILE_COUNT_VERTICAL",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TILE_DOT_BIG",{get:function(){return 254},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TILE_DOT_SMALL",{get:function(){return 255},enumerable:!1,configurable:!0}),t.prototype.getTileAt=function(e,i){return i<0||i>=t.TILE_COUNT_HORIZONTAL||e<0||e>=t.TILE_COUNT_VERTICAL?-1:255&this.data[e][i]},t.prototype.isClearShotColumn=function(t,e,i){for(var o=Math.min(e,i),s=Math.max(e,i),n=o+1;n<s;n++)if(!this.isWalkable(n,t))return!1;return!0},t.prototype.isClearShotRow=function(t,e,i){for(var o=Math.min(e,i),s=Math.max(e,i),n=o+1;n<s;n++)if(!this.isWalkable(t,n))return!1;return!0},t.prototype.isWalkable=function(t,e){var i=this.getTileAt(t,e);return 0===i||i>=240},t.prototype.render=function(e){e.drawImage(this.mazeCanvas,0,0),e.fillStyle="#ffffff";for(var i=0;i<t.TILE_COUNT_VERTICAL;i++)for(var o=8*i+16,s=0;s<t.TILE_COUNT_HORIZONTAL;s++){var n=this.getTileAt(i,s),r=8*s;n===t.TILE_DOT_SMALL?game.drawSmallDot(r+3,o+2):n===t.TILE_DOT_BIG&&game.drawBigDot(r,o)}},t.prototype.reset=function(e){var i=n.default.TILE_SIZE,r=null!=e;if(r&&(this.origMazeInfo=t._cloneObjectOfPrimitives(e)),this.data=t._cloneObjectOfPrimitives(this.origMazeInfo),this.eatenDotCount=0,r){var a=game.assets.get("mapTiles"),h=2*i;this.mazeCanvas=o.ImageUtils.createCanvas(game.getWidth(),game.getHeight());var u=this.mazeCanvas.getContext("2d"),c=0;this.dotCount=0,u.fillStyle="#000000",u.fillRect(0,0,this.mazeCanvas.width,this.mazeCanvas.height),game.drawScoresHeaders(u);for(var l=0;l<this.data.length;l++)for(var d=this.data[l],p=0;p<d.length;p++){var f=d[p];switch((0===f||f>=240)&&c++,f){case t.TILE_DOT_SMALL:case t.TILE_DOT_BIG:this.dotCount++;break;default:if(--f>-1){var g=p*i,m=h+l*i;a.drawByIndex(u,g,m,f)}}}this.nodeCache||(this.nodeCache=new o.Pool(s.MazeNode,c))}},t}();e.Maze=a},4238:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MazeNode=void 0;var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.row=t,this.col=e}return t.prototype.equals=function(t){return this.row===t.row&&this.col===t.col},t.prototype.set=function(t,e,i){this.row=t,this.col=e,this.parent=i},t.prototype.toString=function(){return"[MazeNode: ("+this.row+","+this.col+")]"},t}();e.MazeNode=i},2470:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.MazeState=void 0;var n=i(1510),r=i(6296),a=i(9570),h=i(837),u=i(5686),c=i(6844),l=i(3903),d=i(4822),p=function(t){function e(e){var i=t.call(this)||this;return i._mazeFile=e,i}return s(e,t),Object.defineProperty(e,"DYING_FRAME_DELAY_MILLIS",{get:function(){return 75},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyDelayMillis",{get:function(){return this.firstTimeThrough?4500:2e3},enumerable:!1,configurable:!0}),e.prototype.enter=function(){game.pacman.reset(),game.resetGhosts(),this.maze=new r.Maze(this._mazeFile),this.firstTimeThrough=!0,this.updateScoreIndex=-1,this.lastMazeScreenKeypressTime=game.playTime+e.INPUT_REPEAT_MILLIS,this.substate="READY",this.firstTimeThrough=!0,this.substateStartTime=0,this.nextDyingFrameTime=0,this.nextUpdateTime=0,this._lastSpriteFrameTime=0},e.prototype.paintExtraLives=function(t){var e=game.lives;if(e>0)for(var i=24,o=game.getHeight()-16,s=0;s<e;s++)game.drawSprite(i,o,192,48),i+=16},e.prototype.paintPossibleFruits=function(t){var e=d.default.TILE_SIZE,i=game.getWidth()-12-2*e,o=game.getHeight()-2*e;switch(game.level){default:case 7:game.drawSprite(i-112,o,208,48);case 6:game.drawSprite(i-96,o,208,96);case 5:game.drawSprite(i-80,o,192,96);case 4:game.drawSprite(i-64,o,208,32);case 3:game.drawSprite(i-48,o,208,80);case 2:game.drawSprite(i-32,o,192,80);case 1:game.drawSprite(i-16,o,208,64);case 0:game.drawSprite(i,o,192,64)}},e.prototype.render=function(e){t.prototype.render.call(this,e),this.maze.render(e);var i=game.getHeight()-16-8*r.Maze.TILE_COUNT_VERTICAL;e.translate(0,i),game.drawFruit(e);var o=game.pacman;if(-1===this.updateScoreIndex)"GAME_OVER"!==this.substate&&o.render(e);else{var s=o.bounds.x,n=o.bounds.y;game.paintPointsEarned(e,this.updateScoreIndex,s,n)}if(game.drawGhosts(e),e.translate(0,-i),game.drawScores(e),this.paintExtraLives(e),this.paintPossibleFruits(e),"READY"===this.substate){var a="READY!";s=(game.getWidth()-9*a.length)/2,s+=3,game.drawString(s,160,a)}else if("GAME_OVER"===this.substate){var h="GAME OVER";s=(game.getWidth()-9*h.length)/2,game.drawString(s,160,h)}if(game.paused){e.globalAlpha=.4,e.fillStyle="black",e.fillRect(0,0,game.getWidth(),game.getHeight()),e.globalAlpha=1,e.fillRect(50,100,game.getWidth()-100,game.getHeight()-200);var u="PAUSED";s=(game.getWidth()-9*u.length)/2,game.drawString(s,(game.getHeight()-18)/2,u)}},e.prototype.reset=function(){this.maze.reset(),game.resetPlayTime(),game.pacman.reset(),game.resetGhosts(),this.substate="READY",this.substateStartTime=0,this._lastSpriteFrameTime=0,this.lastMazeScreenKeypressTime=game.playTime+e.INPUT_REPEAT_MILLIS},e.prototype.handleInput=function(t,i){this.handleDefaultKeys();var o=game.inputManager;if("GAME_OVER"!==this.substate&&o.enter(!0))return game.paused=!game.paused,void(this.lastMazeScreenKeypressTime=i);if(!game.paused)switch(this.substate){case"IN_GAME":game.pacman.handleInput(this.maze);break;case"GAME_OVER":o.enter(!0)&&game.setState(new h.TitleState(game))}i>=this.lastMazeScreenKeypressTime+e.INPUT_REPEAT_MILLIS&&!game.paused&&"IN_GAME"===this.substate&&o.isKeyDown(l.Keys.KEY_Z)&&(o.isKeyDown(l.Keys.KEY_X)?(game.loadNextLevel(),this.lastMazeScreenKeypressTime=i):o.isKeyDown(l.Keys.KEY_C)&&"DYING"!==this.substate&&(game.startPacmanDying(),this.substate="DYING",this.nextDyingFrameTime=i+e.DYING_FRAME_DELAY_MILLIS,this.lastMazeScreenKeypressTime=i))},e.prototype.update=function(i){t.prototype.update.call(this,i),this.handleInput(i,game.playTime);var o=game.playTime;switch(this.substate){case"READY":this.firstTimeThrough&&0===this.substateStartTime&&(this.substateStartTime=o,game.audio.playSound(u.default.OPENING)),o>=this.substateStartTime+this.readyDelayMillis&&(this.substate="IN_GAME",this.substateStartTime=o,game.resetPlayTime(),this.lastMazeScreenKeypressTime=game.playTime,game.setLoopedSound(u.default.SIREN),this.firstTimeThrough=!1);break;case"IN_GAME":this.updateInGameImpl(o);break;case"DYING":o>=this.nextDyingFrameTime&&(game.pacman.incDying()?this.nextDyingFrameTime=o+e.DYING_FRAME_DELAY_MILLIS:game.increaseLives(-1)<=0?this.substate="GAME_OVER":(game.resetPlayTime(),this.lastMazeScreenKeypressTime=game.playTime,game.pacman.reset(),game.resetGhosts(),this.substate="READY",this.substateStartTime=0,this._lastSpriteFrameTime=0))}},e.prototype.updateInGameImpl=function(t){if(!(this.nextUpdateTime>0&&t<this.nextUpdateTime)){this.nextUpdateTime=0,this.updateScoreIndex=-1,this._updateSpriteFrames(),game.updateSpritePositions(this.maze,t);var i=game.checkForCollisions();if(i)switch(i.motionState){case c.MotionState.BLUE:this.nextUpdateTime=t+a.PacmanGame.SCORE_DISPLAY_LENGTH,i.motionState=c.MotionState.EYES,this.updateScoreIndex=game.ghostEaten(i);break;case c.MotionState.EYES:case c.MotionState.EYES_ENTERING_BOX:break;default:game.godMode||(game.startPacmanDying(),this.substate="DYING",this.nextDyingFrameTime=game.playTime+e.DYING_FRAME_DELAY_MILLIS)}}},e}(n._BaseState);e.MazeState=p},3116:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Pacman=void 0;var n=i(5717),r=i(3190),a=i(4822),h=function(t){function e(){var e=t.call(this,3)||this;return e._dyingFrame=0,e}return s(e,t),e.prototype.getUpdateDelayMillis=function(){return 10},e.prototype.handleInput=function(t){var e=game.inputManager;e.left()?this.getCanMoveLeft(t)&&(this.direction=n.Direction.WEST):e.right()&&this.getCanMoveRight(t)&&(this.direction=n.Direction.EAST),e.up()?this.getCanMoveUp(t)&&(this.direction=n.Direction.NORTH):e.down()&&this.getCanMoveDown(t)&&(this.direction=n.Direction.SOUTH)},e.prototype.incDying=function(){return this._dyingFrame=(this._dyingFrame+1)%12,0!==this._dyingFrame},e.prototype.render=function(t){var e,i,o=a.default.SPRITE_SIZE,s=this.bounds.x,n=this.bounds.y;this._dyingFrame>0?(e=o*this._dyingFrame,i=96):(e=this.direction*o*this.getFrameCount()+this.getFrame()*o,i=80),game.drawSprite(s,n,e,i)},e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=n.Direction.WEST,this.setLocation(104,188),this._frame=0},e.prototype.setLocation=function(e,i){t.prototype.setLocation.call(this,e,i)},e.prototype.startDying=function(){this._dyingFrame=1},e.prototype.updatePositionImpl=function(t){var e=this.moveAmount;switch(this.direction){case n.Direction.WEST:this.goLeftIfPossible(t,e);break;case n.Direction.EAST:this.goRightIfPossible(t,e);break;case n.Direction.NORTH:this.goUpIfPossible(t,e);break;case n.Direction.SOUTH:this.goDownIfPossible(t,e)}game.increaseScore(t.checkForDot(this.row,this.column))},e}(r._BaseSprite);e.Pacman=h},9570:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.PacmanGame=e.GhostUpdateStrategy=void 0;var n,r=i(3903),a=i(5686),h=i(3116),u=i(10),c=i(755),l=i(9520),d=i(8403),p=i(5912),f=i(2470),g=i(6296),m=i(4822);!function(t){t[t.UPDATE_ALL=0]="UPDATE_ALL",t[t.UPDATE_NONE=1]="UPDATE_NONE",t[t.UPDATE_ONE=2]="UPDATE_ONE"}(n=e.GhostUpdateStrategy||(e.GhostUpdateStrategy={}));var y=function(t){function e(e){var i=t.call(this,e)||this;return i.highScore=5e4,i.pacman=new h.Pacman,i.ghosts=i._createGhostArray(),i.chompSound=0,i._ghostUpdateStrategy=n.UPDATE_ALL,i.score=0,i.desktopGame=e.desktopGame?e.desktopGame:i._isRunningInElectron(),i.extraPointsArray=[100,200,300,400,500,700,800,1e3,1600,2e3,3e3,5e3],i._possiblyRegisterDesktopModeListeners(),i}return s(e,t),e.prototype.addFruit=function(){this.fruit||(this.fruit=new u.Fruit,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1)},e.prototype.checkForCollisions=function(){for(var t=0;t<this.ghosts.length;t++)if(this.pacman.intersects(this.ghosts[t]))return this.ghosts[t];return this.fruit&&-1===this.fruitScoreIndex&&this.pacman.intersects(this.fruit)&&(this.increaseScore(this.extraPointsArray[this.fruit.pointsIndex]),this.audio.playSound(a.default.EATING_FRUIT,!1),this.fruitScoreIndex=this.fruit.pointsIndex,this.fruitScoreEndTime=this.playTime+e.SCORE_DISPLAY_LENGTH),null},e.prototype.checkLoopedSound=function(){if(!this.resettingGhostStates){for(var t=!1,e=0;e<this.ghosts.length;e++){if(this.ghosts[e].isEyes())return void this.setLoopedSound(a.default.EYES_RUNNING);this.ghosts[e].isBlue()&&(t=!0)}this.setLoopedSound(t?a.default.CHASING_GHOSTS:a.default.SIREN)}},e.prototype._createGhostArray=function(){var t=[];return this.resettingGhostStates=!0,t.push(new c.Blinky(this)),t.push(new l.Pinky(this)),t.push(new d.Inky(this)),t.push(new p.Clyde(this)),this.resettingGhostStates=!1,t},e.prototype.drawBigDot=function(t,e){var i=this.playTime;if(i<0||i%500>250){var o=this.canvas.getContext("2d");this.assets.get("sprites").drawScaled2(o,135,38,8,8,t,e,8,8)}},e.prototype.drawFruit=function(t){this.fruit&&this.fruitScoreIndex>-1?(this.paintPointsEarned(t,this.fruitScoreIndex,this.fruit.x,this.fruit.y),this.playTime>=this.fruitScoreEndTime&&(this.fruit=null,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1)):this.fruit&&this.fruit.paint(t)},e.prototype.drawGhosts=function(t){this.ghosts.forEach((function(e){e.paint(t)}))},e.prototype.drawScores=function(t){var e=this.score.toString(),i=55-8*e.length;this.drawString(i,10,e,t),i=132-8*(e=this.highScore.toString()).length,this.drawString(i,10,e,t)},e.prototype.drawScoresHeaders=function(t){this.drawString(16,0,"1UP",t),this.drawString(67,0,"HIGH SCORE",t)},e.prototype.drawSmallDot=function(t,e){this.canvas.getContext("2d").fillRect(t,e,2,2)},e.prototype.drawSprite=function(t,e,i,o){var s=this.assets.get("sprites"),n=this.canvas.getContext("2d");s.drawScaled2(n,i,o,16,16,t,e,16,16)},e.prototype.drawString=function(t,e,i,o){void 0===o&&(o=this.canvas.getContext("2d"));for(var s,n=i.toString(),r=this.assets.get("font"),a="A".charCodeAt(0),h="0".charCodeAt(0),u=0;u<n.length;u++){var c=n[u],l=n.charCodeAt(u);if(c>="A"&&c<="Z")s=r.colCount+(l-a);else if(c>="0"&&c<="9")s=l-h;else switch(c){case"-":s=10;break;case".":s=11;break;case">":s=12;break;case"@":s=13;break;case"!":s=14;break;default:s=15}r.drawByIndex(o,t,e,s),t+=9}},e.prototype.getGhost=function(t){return this.ghosts[t]},Object.defineProperty(e.prototype,"godMode",{get:function(){return this._godMode},enumerable:!1,configurable:!0}),Object.defineProperty(e,"EXTRA_LIFE_SCORE",{get:function(){return 1e4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lives",{get:function(){return this._lives},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"PENALTY_BOX_EXIT_X",{get:function(){return(this.getWidth()-m.default.SPRITE_SIZE)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"PENALTY_BOX_EXIT_Y",{get:function(){return 12*m.default.TILE_SIZE-m.default.TILE_SIZE/2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SCORE_DISPLAY_LENGTH",{get:function(){return 750},enumerable:!1,configurable:!0}),e.prototype.ghostEaten=function(t){switch(this.eatenGhostPointsIndex){case 0:this.eatenGhostPointsIndex=1;break;case 1:this.eatenGhostPointsIndex=3;break;case 3:this.eatenGhostPointsIndex=6;break;default:this.eatenGhostPointsIndex=8}return this.increaseScore(this.extraPointsArray[this.eatenGhostPointsIndex]),this.audio.playSound(a.default.EATING_GHOST),this.eatenGhostPointsIndex},e.prototype.increaseLives=function(t){return this._lives+=t},e.prototype.increaseScore=function(t){this.score+=t,this.score>this.highScore&&(this.highScore=this.score),!this.earnedExtraLife&&this.score>=e.EXTRA_LIFE_SCORE&&(this.audio.playSound(a.default.EXTRA_LIFE),this.increaseLives(1),this.earnedExtraLife=!0)},e.prototype.isDesktopGame=function(){return this.desktopGame},e.prototype._isRunningInElectron=function(){var t=window;return t&&t.process&&t.process.type},e.prototype.loadNextLevel=function(){this.setLoopedSound(null),this._level++,this.fruit=null,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1,this.state.reset()},e.prototype.makeGhostsBlue=function(){this.eatenGhostPointsIndex=0,this.ghosts.forEach((function(t){t.possiblyTurnBlue()})),this.checkLoopedSound()},e.prototype.paintPointsEarned=function(t,e,i,o){this.assets.get("points").drawByIndex(t,i,o,e)},e.prototype.playChompSound=function(){this.audio.playSound(0===this.chompSound?a.default.CHOMP_1:a.default.CHOMP_2),this.chompSound=(this.chompSound+1)%2},e.prototype._possiblyRegisterDesktopModeListeners=function(){var t=this;this.isDesktopGame()&&window.addEventListener("resize",(function(){r.CanvasResizer.resize(t.canvas,t.stretchMode)}))},e.prototype.resetGhosts=function(){this.resettingGhostStates=!0;for(var t=[new r.Point(2,1),new r.Point(2,g.Maze.TILE_COUNT_HORIZONTAL-2),new r.Point(g.Maze.TILE_COUNT_VERTICAL-2,1),new r.Point(g.Maze.TILE_COUNT_VERTICAL-2,g.Maze.TILE_COUNT_HORIZONTAL-2)],e=r.Utils.randomInt(4),i=0;i<this.ghosts.length;i++)this.ghosts[i].reset(),this.ghosts[i].setCorner(t[(e+i)%4]);this.resettingGhostStates=!1},e.prototype.setLoopedSound=function(t){t!==this.loopedSoundName&&(null!=this.loopedSoundId&&this.audio.stopSound(this.loopedSoundId),this.loopedSoundName=t,this.loopedSoundId=null!=t?this.audio.playSound(t,!0):null)},Object.defineProperty(e.prototype,"ghostUpdateStrategy",{set:function(t){this._ghostUpdateStrategy=t},enumerable:!1,configurable:!0}),e.prototype.startGame=function(t){this._lives=3,this.score=0,this._level=0;var e=this.assets.get("levels")[t],i=new f.MazeState(e);this.setState(i)},e.prototype.startPacmanDying=function(){this.setLoopedSound(null),this.audio.playSound(a.default.DIES),this.pacman.startDying(),this.fruit=null,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1},e.prototype.toggleGodMode=function(){return this._godMode=!this._godMode,this.setStatusMessage("God mode "+(this._godMode?"enabled":"disabled")),this._godMode},e.prototype.toggleStretchMode=function(){if(this.isDesktopGame()){switch(this.stretchMode){default:case r.StretchMode.STRETCH_NONE:this.stretchMode=r.StretchMode.STRETCH_FILL;break;case r.StretchMode.STRETCH_FILL:this.stretchMode=r.StretchMode.STRETCH_PROPORTIONAL;break;case r.StretchMode.STRETCH_PROPORTIONAL:this.stretchMode=r.StretchMode.STRETCH_NONE}this.setStatusMessage("Stretch mode: "+r.StretchMode[this.stretchMode]),r.CanvasResizer.resize(this.canvas,this.stretchMode)}},e.prototype.updateSpriteFrames=function(){this.pacman.updateFrame(),this.ghosts.forEach((function(t){t.updateFrame()}))},e.prototype.updateSpritePositions=function(t,e){switch(this._ghostUpdateStrategy){case n.UPDATE_ALL:this.ghosts.forEach((function(i){i.updatePosition(t,e)}));break;case n.UPDATE_NONE:break;case n.UPDATE_ONE:this.ghosts[0].updatePosition(t,e)}this.pacman.updatePosition(t,e)},e}(r.Game);e.PacmanGame=y},9520:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Pinky=void 0;var n=i(6844),r=i(5717),a=i(4822),h=function(t){function e(e){return t.call(this,e,2*a.default.SPRITE_SIZE,2)||this}return s(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=r.Direction.NORTH,this.setLocation(14*a.default.TILE_SIZE-a.default.TILE_SIZE/2-4,15*a.default.TILE_SIZE-a.default.TILE_SIZE/2),this.motionState=n.MotionState.IN_BOX},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount,i=game.pacman,o=i.row,s=i.column,a=this.row,h=this.column,u=!1;this.atIntersection(t)?(a===o&&t.isClearShotRow(a,h,s)?(s<h?(this.direction=r.Direction.WEST,this.incX(-e)):this.goRightIfPossible(t,e)||this.changeDirectionFallback(t),u=!0):h===s&&t.isClearShotColumn(h,a,o)&&(o<a?(this.direction=r.Direction.NORTH,this.incY(-e)):this.goDownIfPossible(t,e)||this.changeDirectionFallback(t),u=!0),u||this.changeDirectionFallback(t)):this.continueInCurrentDirection(e),game.playTime>=this.startScatteringTime&&(this.motionState=n.MotionState.SCATTERING)},e}(n.Ghost);e.Pinky=h},5686:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={CHASING_GHOSTS:"chasingGhosts",CHOMP_1:"chomp1",CHOMP_2:"chomp2",DIES:"dies",EATING_FRUIT:"eatingFruit",EATING_GHOST:"eatingGhost",EXTRA_LIFE:"extraLife",INTERMISSION:"intermission",EYES_RUNNING:"eyesRunning",OPENING:"opening",SIREN:"siren",TOKEN:"token"}},837:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.TitleState=void 0;var n=i(1510),r=i(5717),a=i(5686),h=i(4822),u=function(t){function e(e){var i=t.call(this,e)||this;return i._initSprites(),i.handleStart=i.handleStart.bind(i),i}return s(e,t),e.prototype.enter=function(){t.prototype.enter.call(this,game),game.canvas.addEventListener("touchstart",this.handleStart,{capture:!1,passive:!0}),this.choice=0,this.lastKeypressTime=game.playTime,this._initSprites()},e.prototype._initSprites=function(){var t=game.pacman;t.setLocation(game.getWidth()/2,240),t.direction=r.Direction.EAST;var e=game.getGhost(0);e.setLocation(game.getWidth()/2-3*h.default.SPRITE_SIZE,240),e.direction=r.Direction.EAST},e.prototype.leaving=function(t){t.canvas.removeEventListener("touchstart",this.handleStart,!1)},e.prototype.handleStart=function(){this.startGame()},e.prototype.render=function(t){var e=game.getWidth(),i=game.getHeight();this.renderStaticStuff(t);var o=(e-135)/2-5,s=(i-30)/2;this.game.drawString(o,s+15*this.choice,">"),o+=13.5,s=200,game.canvas.getContext("2d").fillStyle="#ffffff",game.drawSmallDot(o+3,s+2),s+=9,game.drawBigDot(o,s),game.pacman.render(t),game.getGhost(0).paint(t),game.audio.isInitialized()||this.renderNoSoundMessage()},e.prototype.stringWidth=function(t){return game.assets.get("font").cellW*t.length},e.prototype.renderNoSoundMessage=function(){var t=game.getWidth(),e="SOUND IS DISABLED AS",i=(t-this.stringWidth(e))/2,o=game.getHeight()-20-27;this.game.drawString(i,o,e),e="YOUR BROWSER DOES NOT",i=(t-this.stringWidth(e))/2,o+=9,this.game.drawString(i,o,e),e="SUPPORT WEB AUDIO",i=(t-this.stringWidth(e))/2,o+=9,this.game.drawString(i,o,e)},e.prototype.renderStaticStuff=function(t){var e=this.game;e.clearScreen("rgb(0,0,0)");var i=e.getWidth();e.drawScores(t),e.drawScoresHeaders(t);var o=e.assets.get("title"),s=(i-o.width)/2,n=1.2*o.height;o.draw(t,s,n);var r="STANDARD MAZE",a=r.length-1;s=(i-9*a)/2-5,n=(e.getHeight()-30)/2,this.game.drawString(s,n,r,t),r="ALTERNATE MAZE",n+=15,this.game.drawString(s,n,r,t),s+=18,a=(r="10 POINTS").length-2,n=200,this.game.drawString(s,n,r,t),r="50 POINTS",n+=9,this.game.drawString(s,n,r,t),s=(i-9*(r="2015 OLD MAN GAMES").length)/2,n=e.getHeight()-20,this.game.drawString(s,n,r,t)},e.prototype.startGame=function(){game.startGame(this.choice)},e.prototype.update=function(t){this.handleDefaultKeys();var e=game.playTime;if(e>this.lastKeypressTime+n._BaseState.INPUT_REPEAT_MILLIS+100){var i=game.inputManager;i.up()?(this.choice=Math.abs(this.choice-1),game.audio.playSound(a.default.TOKEN),this.lastKeypressTime=e):i.down()?(this.choice=(this.choice+1)%2,game.audio.playSound(a.default.TOKEN),this.lastKeypressTime=e):i.enter(!0)&&this.startGame()}var o=game.pacman,s=game.getGhost(0),h=o.moveAmount;o.direction===r.Direction.WEST&&(h=-h),o.incX(h),h=s.moveAmount,s.direction===r.Direction.WEST&&(h=-h),s.incX(h),o.x+o.width>=this.game.getWidth()-30?o.direction=s.direction=r.Direction.WEST:s.x<=30&&(o.direction=s.direction=r.Direction.EAST),this._updateSpriteFrames()},e}(n._BaseState);e.TitleState=u},2666:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fixLevelDatas=void 0;var i=function(t){return parseInt(t,16)};e.fixLevelDatas=function(t){t.forEach((function(t){for(var e=0;e<t.length;e++)t[e]=t[e].map(i)}))}},3190:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e._BaseSprite=void 0;var o=i(3903),s=i(5717),n=i(6296),r=i(4822),a=function(){function t(t){this.bounds=new o.Rectangle(0,0,r.default.SPRITE_SIZE,r.default.SPRITE_SIZE),this._intersectBounds=new o.Rectangle,this.direction=s.Direction.EAST,this._frame=0,this._frameCount=t,this._lastUpdateTime=0}return t.prototype.atIntersection=function(t){switch(this.direction){case s.Direction.NORTH:case s.Direction.SOUTH:return this.getCanMoveLeft(t)||this.getCanMoveRight(t);case s.Direction.EAST:case s.Direction.WEST:return this.getCanMoveUp(t)||this.getCanMoveDown(t)}},t.prototype.getCanMoveDown=function(t){var e=this.centerX,i=this.centerY,o=e%this.TILE_SIZE,n=i%this.TILE_SIZE;if(0===o&&0===n){var r=this.row,a=this.column;return r<30&&t.isWalkable(r+1,a)}return this.direction===s.Direction.NORTH||this.direction===s.Direction.SOUTH},t.prototype.getCanMoveLeft=function(t){var e=this.bounds.x;if(e<0)return!0;e+=this.TILE_SIZE/2;var i=this.centerY,o=e%this.TILE_SIZE,n=i%this.TILE_SIZE;if(0===o&&0===n){var r=this.row,a=this.column;return a>0&&t.isWalkable(r,a-1)}return this.direction===s.Direction.EAST||this.direction===s.Direction.WEST},t.prototype.getCanMoveRight=function(t){var e=this.bounds.x;if(e+this.width>this.SCREEN_WIDTH)return!0;e+=this.TILE_SIZE/2;var i=this.centerY,o=e%this.TILE_SIZE,n=i%this.TILE_SIZE;if(0===o&&0===n){var r=this.row,a=this.column;return a<27&&t.isWalkable(r,a+1)}return this.direction===s.Direction.EAST||this.direction===s.Direction.WEST},t.prototype.getCanMoveUp=function(t){var e=this.centerX,i=this.centerY;e%1==0&&i%1==0||console.error("Unexpected condition: x === "+e+", y === "+i);var o=e%this.TILE_SIZE,n=i%this.TILE_SIZE;if(0===o&&0===n){var r=this.row,a=this.column;return r>0&&t.isWalkable(r-1,a)}return this.direction===s.Direction.NORTH||this.direction===s.Direction.SOUTH},Object.defineProperty(t.prototype,"centerX",{get:function(){return this.bounds.x+this.TILE_SIZE/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"centerY",{get:function(){return this.bounds.y+this.TILE_SIZE/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){var t=Math.floor(this.centerX/this.TILE_SIZE);return t<0?t+=n.Maze.TILE_COUNT_HORIZONTAL:t>=n.Maze.TILE_COUNT_HORIZONTAL&&(t-=n.Maze.TILE_COUNT_HORIZONTAL),t},enumerable:!1,configurable:!0}),t.prototype.getFrame=function(){return this._frame},t.prototype.getFrameCount=function(){return this._frameCount},Object.defineProperty(t.prototype,"intersectBounds",{get:function(){return this._intersectBounds.set(this.bounds.x+2,this.bounds.y-2,this.bounds.w-4,this.bounds.h-4),this._intersectBounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moveAmount",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TILE_SIZE",{get:function(){return 8},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.bounds.w},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return Math.floor(this.centerY/this.TILE_SIZE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.bounds.x},set:function(t){this.bounds.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.bounds.y},set:function(t){this.bounds.y=t},enumerable:!1,configurable:!0}),t.prototype.goDownIfPossible=function(t,e){return!!this.getCanMoveDown(t)&&(this.direction=s.Direction.SOUTH,this.incY(e),!0)},t.prototype.goLeftIfPossible=function(t,e){return!!this.getCanMoveLeft(t)&&(this.direction=s.Direction.WEST,this.incX(-e),!0)},t.prototype.goRightIfPossible=function(t,e){return!!this.getCanMoveRight(t)&&(this.direction=s.Direction.EAST,this.incX(e),!0)},t.prototype.goUpIfPossible=function(t,e){return!!this.getCanMoveUp(t)&&(this.direction=s.Direction.NORTH,this.incY(-e),!0)},t.prototype.incX=function(t){this.bounds.x+=t,this.bounds.x+this.width<=0?this.bounds.x+=this.SCREEN_WIDTH:this.bounds.x>=this.SCREEN_WIDTH&&(this.bounds.x-=this.SCREEN_WIDTH)},t.prototype.incY=function(t){this.bounds.y+=t},t.prototype.intersects=function(t){return this.intersectBounds.intersects(t.intersectBounds)},t.prototype.reset=function(){this._lastUpdateTime=0},Object.defineProperty(t.prototype,"SCREEN_WIDTH",{get:function(){return 224},enumerable:!1,configurable:!0}),t.prototype.setLocation=function(t,e){this.bounds.x=t,this.bounds.y=e},t.prototype.updateFrame=function(){this._frame=(this._frame+1)%this.getFrameCount()},t.prototype.updatePosition=function(t,e){e>this._lastUpdateTime+this.getUpdateDelayMillis()&&(this._lastUpdateTime=e,this.updatePositionImpl(t))},t}();e._BaseSprite=a},1510:function(t,e,i){var o,s=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e._BaseState=void 0;var n=i(3903),r=function(t){function e(e){var i=t.call(this,e)||this;return i._lastConfigKeypressTime=n.Utils.timestamp(),i._lastSpriteFrameTime=0,i}return s(e,t),Object.defineProperty(e,"INPUT_REPEAT_MILLIS",{get:function(){return 200},enumerable:!1,configurable:!0}),e.prototype.handleDefaultKeys=function(){var t=n.Utils.timestamp(),i=this.game.inputManager;if(t>this._lastConfigKeypressTime+e.INPUT_REPEAT_MILLIS&&(i.isKeyDown(n.Keys.KEY_M,!0)&&(game.toggleMuted(),this._lastConfigKeypressTime=t),i.isKeyDown(n.Keys.KEY_Z)))if(i.isKeyDown(n.Keys.KEY_P,!0))(o=game.canvas.style).width||(o.width=game.canvas.width+"px"),o.height||(o.height=game.canvas.height+"px"),o.width=parseInt(o.width.substring(0,o.width.length-2),10)+1+"px",o.height=parseInt(o.height.substring(0,o.height.length-2),10)+1+"px",game.setStatusMessage("Canvas size now: (".concat(o.width,", ").concat(o.height,")")),this._lastConfigKeypressTime=t;else if(i.isKeyDown(n.Keys.KEY_L,!0)){var o;(o=game.canvas.style).width||(o.width=game.canvas.width+"px"),o.height||(o.height=game.canvas.height+"px"),o.width=parseInt(o.width.substring(0,o.width.length-2),10)-1+"px",o.height=parseInt(o.height.substring(0,o.height.length-2),10)-1+"px",game.setStatusMessage("Canvas size now: (".concat(o.width,", ").concat(o.height,")")),this._lastConfigKeypressTime=t}else i.isKeyDown(n.Keys.KEY_G,!0)?(game.toggleGodMode(),this._lastConfigKeypressTime=t):i.isKeyDown(n.Keys.KEY_S,!0)&&game.toggleStretchMode()},e.prototype._updateSpriteFrames=function(){var t=game.playTime;t>=this._lastSpriteFrameTime+100&&(this._lastSpriteFrameTime=t,game.updateSpriteFrames())},e}(n.State);e._BaseState=r}},o={};function s(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return i[t].call(n.exports,n,n.exports,s),n.exports}s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t=s(9570),e=s(81),s(3164),s(603),window.init=function(i,o){var s=window;s.game=new t.PacmanGame({parent:i,width:224,height:288,assetRoot:o,keyRefreshMillis:300,targetFps:60}),s.game.setState(new e.LoadingState),s.game.start()}})();